name: Remove Development Docker Images
on:
  pull_request:
    types: [ closed ]
    
jobs:    
  purge-image:
  name: Delete image from ghcr.io
  runs-on: ubuntu-latest
  steps:
    - name: Get branch name (merge)
      shell: bash
      run: echo "BRANCH_NAME=$(echo ${GITHUB_REF#refs/heads/} | tr / -)" >> $GITHUB_ENV
    - name: Delete image
      uses: bots-house/ghcr-delete-image-action@v1.0.0
      with:
        # NOTE: at now only orgs is supported
        owner: breadboi
        name: rm-old-image
        # NOTE: using Personal Access Token
        token: ${{ secrets.DOCKERDEL }}
        tag: ${{ env.BRANCH_NAME }}
